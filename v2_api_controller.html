<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Md/v2 api controller.md</title>
    
    <link rel="stylesheet" type="text/css" href="http://documentup.com/stylesheets/themes/v1.css">
    
    

    

    <!-- Typekit -->
    
      <script type="text/javascript">
        (function() {
          var config = {
            kitId: 'hjp0pft',
            scriptTimeout: 3000
          };
          var h=document.getElementsByTagName("html")[0];h.className+=" wf-loading";var t=setTimeout(function(){h.className=h.className.replace(/( |^)wf-loading( |$)/g,"");h.className+=" wf-inactive"},config.scriptTimeout);var tk=document.createElement("script");tk.src='//use.typekit.net/'+config.kitId+'.js';tk.type="text/javascript";tk.async="true";tk.onload=tk.onreadystatechange=function(){var a=this.readyState;if(a&&a!="complete"&&a!="loaded")return;clearTimeout(t);try{Typekit.load(config)}catch(b){}};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(tk,s)
        })();
      </script>
    
  </head>
  <body><div id="container">
  <div id="nav">
    
      <div id="header">
        <a href="#" id="logo">Md/v2 api controller.md</a>
      </div>
    
    <ul id="sections">
      
        <li>
          <a href="#v2-api">V2 API</a>
          
        </li>
      
        <li>
          <a href="#general-usage">General Usage</a>
          
            <ul>
              
                <li>
                  <a href="#general-usage/restful-api">RESTful API</a>
                </li>
              
                <li>
                  <a href="#general-usage/list-of-resouces-available">List of Resouces Available</a>
                </li>
              
                <li>
                  <a href="#general-usage/special-considerations-for-cross-browser-scripting-restrictions">Special Considerations for Cross-Browser Scripting Restrictions</a>
                </li>
              
            </ul>
          
        </li>
      
        <li>
          <a href="#quick-start">Quick Start</a>
          
            <ul>
              
                <li>
                  <a href="#quick-start/prerequisite-data">Prerequisite Data</a>
                </li>
              
                <li>
                  <a href="#quick-start/specifying-a-results-format">Specifying a results format.</a>
                </li>
              
            </ul>
          
        </li>
      
        <li>
          <a href="#access-modes">Access Modes</a>
          
            <ul>
              
                <li>
                  <a href="#access-modes/via-scormcloud-app-id-and-secret-key">Via SCORMCloud App ID and Secret Key</a>
                </li>
              
                <li>
                  <a href="#access-modes/via-bright-api-key">Via Bright API Key</a>
                </li>
              
                <li>
                  <a href="#access-modes/via-realm-id-and-secret-key">Via Realm ID and Secret Key</a>
                </li>
              
            </ul>
          
        </li>
      
        <li>
          <a href="#api-modules">API Modules</a>
          
            <ul>
              
                <li>
                  <a href="#api-modules/registration">Registration</a>
                </li>
              
                <li>
                  <a href="#api-modules/course">Course</a>
                </li>
              
                <li>
                  <a href="#api-modules/realm-user">Realm User</a>
                </li>
              
                <li>
                  <a href="#api-modules/api-key">API Key</a>
                </li>
              
            </ul>
          
        </li>
      
        <li>
          <a href="#debugging-errors">Debugging Errors</a>
          
            <ul>
              
                <li>
                  <a href="#debugging-errors/fetching-http-error-codes-from-a-get-request">Fetching HTTP Error Codes from a GET Request</a>
                </li>
              
                <li>
                  <a href="#debugging-errors/fetching-http-error-codes-from-a-post-request">Fetching HTTP Error Codes from a POST Request</a>
                </li>
              
                <li>
                  <a href="#debugging-errors/debugging-authentication-errors">Debugging Authentication Errors</a>
                </li>
              
            </ul>
          
        </li>
      
    </ul>
    
    
  </div>
  <div id="content">
    
    <p><img src="http://www.aura-software.com/wp-content/uploads/2012/04/lightbulb2-inverted-01.png" alt="Bright">

</p>
<h2 id='v2-api'>V2 API</h2 id='v2-api'>
<p>This document describes how to use version 2 of the Bright API.

</p>
<p>The Bright API provides programmatic access to a variety of functions provided by the Bright platform, most
significantly read and write access to the Bright database.  Via the API it is possible to register users, assign
courses, generate launch URLs, and query results.

</p>
<p>This document details how to get connected to the Bright Server, how to authenticate, and what functions
are available via which API calls.  It also covers what to do when things go wrong, and how to get more information.

</p>
<p>More information about Bright and the Bright platform can be accessed from the <a href="http://www.aura-software.com">Aura Homepage</a>.

</p>
<h2 id='general-usage'>General Usage</h2 id='general-usage'>
<p>The Bright API is used to interact with Bright Server.  Typical things you might do with Bright are

</p>
<ul>
<li>access data about learners, courses, registrations.</li>
<li>You might be querying data or pushing data in.</li>
</ul>
<p>Regardless, all Bright API calls function in the same way.
Fundamentally, the Bright API is a RESTful API, so much of what is covered here should seem familiar if you&#39;ve worked
with a RESTful API before.  If not, you may want to familiarize yourself with the concepts here:
<a href="http://en.wikipedia.org/wiki/Representational_state_transfer">http://en.wikipedia.org/wiki/Representational_state_transfer</a> .

</p>
<p><img src="http://content.screencast.com/users/bretweinraub/folders/Jing/media/65b3da97-8fc0-47da-bc21-77159d7021c7/00000306.png" alt="">
Source: <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">Wikipedia</a>

</p>
<h3 id='general-usage/restful-api'>RESTful API</h3 id='general-usage/restful-api'>
<p>The Restful api of bright is built around our main resource types:

</p>
<ul>
<li>courses</li>
<li>registrations</li>
<li>users</li>
<li>api keys</li>
<li>invitations</li>
</ul>
<p>for each resource type, we follow the following model, where a specific path, http verb and action are consistent depending on the bright
resource you are accessing.

</p>
<table>
    <tr>
        <th><span class="caps">HTTP</span> Verb </th>
        <th>Path            </th>
        <th>action </th>
        <th>used for                                   </th>
    </tr>
    <tr>
        <td><span class="caps">GET</span>          </td>
        <td>/{{resource}}           </td>
        <td>index    </td>
        <td>display a list of all {{resource}} [Note: Bright does not implement this canonical REST action].                </td>
    </tr>
    <tr>
        <td><span class="caps">GET</span>          </td>
        <td>/{{resource}}/new       </td>
        <td>new      </td>
        <td>return an <span class="caps">HTML</span> form for creating a new {{resource}} </td>
    </tr>
    <tr>
        <td><span class="caps">POST</span>         </td>
        <td>/{{resource}}           </td>
        <td>create   </td>
        <td>create a new {{resource}}                           </td>
    </tr>
    <tr>
        <td><span class="caps">GET</span>         </td>
        <td>/{{resource}}/gcreate</td>
        <td>create   </td>
        <td>create a new {{resource}} with a GET request.  This is an alias to the POST get request provided to allow the {{resource} to be created from a web browser without using a POST.  A variety of cross-domain scripting issues can be addressed using the GET create alias (gcreate).</td>
    </tr>

    <tr>
        <td><span class="caps">GET</span>          </td>
        <td>/{{resource}}/:id       </td>
        <td>show     </td>
        <td>display a specific {{resource}}                     </td>
    </tr>
    <tr>
        <td><span class="caps">GET</span>          </td>
        <td>/{{resource}}/:id/edit  </td>
        <td>edit     </td>
        <td>return an <span class="caps">HTML</span> form for editing a {{resource}}      </td>
    </tr>
    <tr>
        <td><span class="caps">PUT</span>          </td>
        <td>/{{resource}}/:id       </td>
        <td>update   </td>
        <td>update a specific {{resource}}                      </td>
    </tr>
    <tr>
        <td><span class="caps">GET</span>          </td>
        <td>/{{resource}}/gupdate/:id       </td>
        <td>update   </td>
        <td>update a specific {{resource}} via a GET request.  See the comment on gcreate above.</td>
    </tr>
    <tr>
        <td><span class="caps">DELETE</span>       </td>
        <td>/{{resource}}/:id       </td>
        <td>destroy  </td>
        <td>delete a specific {{resource}}                      </td>
    </tr>
</table>

<h3 id='general-usage/list-of-resouces-available'>List of Resouces Available</h3 id='general-usage/list-of-resouces-available'>
<ul>
<li>Bright Api Keys (/bright/api/v2/api_key)</li>
<li>Course Provider (/bright/api/v2/course_provider)</li>
<li>Courses (/bright/api/v2/course)</li>
<li>Registrations (/bright/api/v2/registation)</li>
<li>Realm User (/bright/api/v2/realm_user)</li>
<li>Embed Templates (/bright/api/v2/embed_template) [Note: in v3, this will be renamed simply &quot;template&quot;].</li>
<li>Invitations (/bright/api/v2/invitation)</li>
</ul>
<h3 id='general-usage/special-considerations-for-cross-browser-scripting-restrictions'>Special Considerations for Cross-Browser Scripting Restrictions</h3 id='general-usage/special-considerations-for-cross-browser-scripting-restrictions'>
<p>One thing about the RESTFul architecture is does not interoperate well with cross browser scripting restrictions
in modern browsers.  Specifically, you are probably aware that you can not POST or PUT data via JSONP which means
you can interact with a <em>pure</em> RESTFul API from a web page delivered from a web server other the one hosting the
Bright API.

</p>
<p>To alleviate this problem, we provide two &quot;GET&quot;-oriented aliases, gcreate and gupdate, that work identically to
create and update, and are available via HTTP GET calls.

</p>
<h2 id='quick-start'>Quick Start</h2 id='quick-start'>
<p>In the section we will quickly work throw the steps of connecting to the Bright API, authenticating, and generating
API calls.

</p>
<h3 id='quick-start/prerequisite-data'>Prerequisite Data</h3 id='quick-start/prerequisite-data'>
<ul>
<li>Your Bright API URL.  This will be provided to you and is based on where your Bright server is installed, and what
DNS entry is used to access it.  Don&#39;t know it?  Ask us at support@aura-software.com!</li>
</ul>
<p>If you are using a SCORMCloud course provider, API access can be provided using your SCORMCloud APP ID and secret key.  These are
available from Aura Support, or from the SCORMCloud console available at <a href="https://cloud.scorm.com">https://cloud.scorm.com</a>.

</p>
<ul>
<li>The SCORMCloud APP ID for your SCORMCloud Application.</li>
<li>The SCORMCloud Secret Key for your SCORMCloud Application.</li>
</ul>
<p>Here&#39;s an example of fetching these values from the SCORMCloud administration console:

</p>
<p><img src="http://content.screencast.com/users/bretweinraub/folders/Jing/media/a0ebfd4c-e41d-41f0-8a80-abc4415ddc42/00000554.png" alt="SCORMCloud App">

</p>
<p>You can access this by selection &quot;Apps&quot; from the SCORMCloud administration console left hand menu.

</p>
<p>You can also access Bright with a Bright realm app id and key <a href="#access-modes/via-realm-id-and-secret-key">see section</a>.

</p>
<p>Certain functionality can only be accessed with a realm key, such as invitations or the utilization of multiple course providers.

</p>
<p>For the purposes of this example, we will use the following:

</p>
<ul>
<li>Bright API URL: <a href="http://[BRIGHT">http://[BRIGHT</a> URL]/bright/api/v2</li>
<li>SCORMCloud APPID: <strong>RQIBAXU49I</strong></li>
<li>SCORMCloud Secret Key: <strong>nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N</strong></li>
</ul>
<p>With the above information, we can already use our API.  To do so, we can test this straight from curl a command line tool that is
easy to install on most systems.

</p>
<p>When learning the Bright API, we recommend you start by assembling some simple curl commands from your command line in order to get
a feel for what is possible.

</p>
<p>So let&#39;s get our list of course from our API:

</p>
<pre><code class="shell">curl <span class="comment">'http://[BRIGHT URL]/bright/api/v2/course.xml?sc_app_id=RQIBAXU49I&amp;</span>
sc_secret_key=nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N<span class="comment">'</span></code></pre>
<p>If you&#39;ve executed this correctly, you&#39;ll get a result like:

</p>
<p>And the result:

</p>
<pre><code class="xml">
  <span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?></span>
  <span class="tag">&lt;<span class="title">scorm-cloud-courses</span> <span class="attribute">type</span>=<span class="value">"array"</span>></span>
    <span class="tag">&lt;<span class="title">scorm-cloud-course</span>></span>
      <span class="tag">&lt;<span class="title">course-provider-id</span> <span class="attribute">type</span>=<span class="value">"integer"</span>></span>6<span class="tag">&lt;/<span class="title">course-provider-id</span>></span>
      <span class="tag">&lt;<span class="title">created-at</span> <span class="attribute">type</span>=<span class="value">"datetime"</span>></span>2012-11-26T12:10:40Z<span class="tag">&lt;/<span class="title">created-at</span>></span>
      <span class="tag">&lt;<span class="title">custom</span>></span><span class="tag">&lt;/<span class="title">custom</span>></span>
      <span class="tag">&lt;<span class="title">id</span> <span class="attribute">type</span>=<span class="value">"integer"</span>></span>184<span class="tag">&lt;/<span class="title">id</span>></span>
      <span class="tag">&lt;<span class="title">metadata</span>></span>{"title":"ENT Foundation - Post Training QUIZ",
                 "description":"",
                 "duration":"0",
                 "typicaltime":"0",
                 "keywords":null}
       <span class="tag">&lt;/<span class="title">metadata</span>></span>
      <span class="tag">&lt;<span class="title">registration-count</span> <span class="attribute">type</span>=<span class="value">"integer"</span>></span>1<span class="tag">&lt;/<span class="title">registration-count</span>></span>
      <span class="tag">&lt;<span class="title">sc-course-id</span>></span>1-507727747154e<span class="tag">&lt;/<span class="title">sc-course-id</span>></span>
      <span class="tag">&lt;<span class="title">size</span> <span class="attribute">type</span>=<span class="value">"integer"</span>></span>157758<span class="tag">&lt;/<span class="title">size</span>></span>
      <span class="tag">&lt;<span class="title">title</span>></span>System Test Course<span class="tag">&lt;/<span class="title">title</span>></span>
      <span class="tag">&lt;<span class="title">updated-at</span> <span class="attribute">type</span>=<span class="value">"datetime"</span>></span>2013-01-17T16:20:10Z<span class="tag">&lt;/<span class="title">updated-at</span>></span>
      <span class="tag">&lt;<span class="title">versions</span> <span class="attribute">type</span>=<span class="value">"integer"</span>></span>-1<span class="tag">&lt;/<span class="title">versions</span>></span>
    <span class="tag">&lt;/<span class="title">scorm-cloud-course</span>></span>
  <span class="tag">&lt;/<span class="title">scorm-cloud-courses</span>></span></code></pre>
<h3 id='quick-start/specifying-a-results-format'>Specifying a results format.</h3 id='quick-start/specifying-a-results-format'>
<h4>Fetching an XML result</h4>
<p>To fetch your results in XML format, append a &#39;.xml&#39; to the url, <em>before</em> the request parameters.  For example

</p>
<pre><code><span class="label">http:</span>//[BRIGHT URL]/bright/api/v2/course<span class="preprocessor">.xml</span></code></pre>
<h4>Fetching a JSON result</h4>
<p>Let&#39;s say if you are using the API from Javascript, and you&#39;d like your results back as JSON.  Easy, just
rewrite the URL to use &#39;course.json&#39; instead of &#39;course.xml&#39;

</p>
<pre><code class="shell">curl <span class="comment">'http://[BRIGHT URL]/bright/api/v2/course.json?</span>
sc_app_id=RQIBAXU49I&amp;
sc_secret_key=nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N<span class="comment">'</span></code></pre>
<p>And the result (formatted for readibility:

</p>
<pre><code class="json">[
 {
     "<span class="attribute">created_at</span>":<span class="value"><span class="string">"2012-11-26T12:10:44Z"</span></span>,
     "<span class="attribute">id</span>":<span class="value"><span class="number">187</span></span>,
     "<span class="attribute">registrations</span>":<span class="value"><span class="number">2</span></span>,
     "<span class="attribute">sc_course_id</span>":<span class="value"><span class="string">"1-5098f07394cbd"</span></span>,
     "<span class="attribute">course_provider_id</span>":<span class="value"><span class="number">6</span></span>,
     "<span class="attribute">size</span>":<span class="value"><span class="number">1599415</span></span>,
     "<span class="attribute">title</span>":<span class="value"><span class="string">"Proktologie"</span></span>,
     "<span class="attribute">updated_at</span>":<span class="value"><span class="string">"2012-11-27T22:30:40Z"</span></span>,
     "<span class="attribute">versions</span>":<span class="value">-<span class="number">1</span>
 </span>},
 {
     "<span class="attribute">created_at</span>":<span class="value"><span class="string">"2012-11-29T16:11:53Z"</span></span>,
     "<span class="attribute">id</span>":<span class="value"><span class="number">200</span></span>,
     "<span class="attribute">registrations</span>":<span class="value"><span class="number">1</span></span>,
     "<span class="attribute">sc_course_id</span>":<span class="value"><span class="string">"1-50b63e903dd43"</span></span>,
     "<span class="attribute">course_provider_id</span>":<span class="value"><span class="number">6</span></span>,
     "<span class="attribute">size</span>":<span class="value"><span class="number">2211931</span></span>,
     "<span class="attribute">title</span>":<span class="value"><span class="string">"Proktologie"</span></span>,
     "<span class="attribute">updated_at</span>":<span class="value"><span class="string">"2012-12-07T15:48:43Z"</span></span>,
     "<span class="attribute">versions</span>":<span class="value">-<span class="number">1</span>
 </span>}
]</code></pre>
<h2 id='access-modes'>Access Modes</h2 id='access-modes'>
<p>The Bright API can be accessed to two different ways:

</p>
<ul>
<li><a href="##access-modes/via-scormcloud-app-id-and-secret-key">SCORMCloud App ID and Secret Key</a></li>
<li><a href="#access-modes/via-bright-api-key">Bright API Key</a></li>
<li>[Brigh Realm GUID and Secret Key) (#access-modes/via-realm-guid-and-secret-key)</li>
</ul>
<p>If you do not specify either the api key/secret key pair <strong>OR</strong> the Bright API key, you will
receive HTTP code 401 (Unauthorized) in your response.

</p>
<p>If you specify multiple authentication models, you will received a 501 (not implemented).

</p>
<p>If you specify an unknown SCORMCloud APPId and Secret key, you will receive a 500 (server error).

</p>
<h3 id='access-modes/via-scormcloud-app-id-and-secret-key'>Via SCORMCloud App ID and Secret Key</h3 id='access-modes/via-scormcloud-app-id-and-secret-key'>
<p>In all of the examples so far, we&#39;ve been using direct access to the API using the SCORMCloud secret key and app id.  Generally speaking, this is fine
for server side code that is secured and publicly accessible.  You should NEVER share the APP ID and secret key since this give complete access to all of
your data.

</p>
<p>Example:

</p>
<pre><code class="shell">curl <span class="comment">'http://[BRIGHT URL]/bright/api/v2/course.json?sc_app_id=\</span>
RQIBAXU49I&amp;sc_secret_key=nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N<span class="comment">'</span></code></pre>
<p>The above example will show all courses for the course provider defined by the SCORMCloud data (app id, secret key).

</p>
<h3 id='access-modes/via-bright-api-key'>Via Bright API Key</h3 id='access-modes/via-bright-api-key'>
<p>If you want to access the Bright API from some browser side Javascript, using the SCORMCloud or Bright Realm secret key is no good.  NEVER put your Secret Key into the browser via Javascript.

</p>
<p>Instead the Bright API allows you to create an authentication token that you can use to send to the browser.  When you generate this token, typically you specify

</p>
<ul>
<li>the SCORMCloud app id/secret key OR bright realm secret key</li>
<li>optionally the user</li>
</ul>
<p>These application tokens are disabled after a short period of time.  Do not hard code the use of a Bright API key, as these keys expire after a period of time.  

</p>
<p>Here&#39;s an example of getting an API token.  This first call creates a special access token to a specific user for a specific SCORMCloud application.  The key that is returned is suitable for 
embedding in a web page for use by browser side Javascript.

</p>
<pre><code class="shell"><span class="title">curl</span> <span class="string">'http://[BRIGHT URL]/bright/api/v2/api_key/create?sc_app_id=RQIBAXU49I
&amp;sc_secret_key=nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N
&amp;user_email=admin<span class="variable">@aura</span>-software.com'</span>
(returns) df8d1350a6b31378a86b967767f4bba1</code></pre>
<p>You can now omit the secret key and app id from subsequent calls and just use the API key:

</p>
<pre><code class="shell">curl <span class="comment">'http://[BRIGHT URL]/bright/api/v2/course.xml?\</span>
api_token=bdb273e9cdace9698c34d97070cb392d<span class="comment">'</span></code></pre>
<p>This API token is now &quot;bound&quot; to the access level specified when the key was created.

</p>
<h3 id='access-modes/via-realm-id-and-secret-key'>Via Realm ID and Secret Key</h3 id='access-modes/via-realm-id-and-secret-key'>
<p>Your Bright realm ID and secret key will be furnished to you by Bright support.  For many functions it is not necessary.  If you aren&#39;t working
with invitations, creating user records on the fly, or using multiple course providers, you probably won&#39;t need a Realm key.  Note you do not
need to create a user to assign a user to a course.  This is done on the fly and if you aren&#39;t populating custom metadata for a user, it is 
not necessary to pre-populate the user.

</p>
<p>If you need to use a realm ID and secret key, it will be provided to you by Aura support.  You can file a request at support@aura-software.com

</p>
<p>For the purposes of this example, we will use the following:

</p>
<ul>
<li>realm_guid: sJLtP8Zt8G0Sbz9kxPjQ</li>
<li>realm_secret_key: PcVQflTCUIbe3ps2T86KXAzvXzdpFcgs5Mvku03uZ8w</li>
</ul>
<p>With these, lets create an api key &#39;bound&#39; to this authentication level:

</p>
<pre><code class="shell">curl <span class="comment">'http://localhost:3000/bright/api/v2/api_key/gcreate?</span>
realm_guid=sJLtP8Zt8G0Sbz9kxPjQ&amp;
realm_secret_key=PcVQflTCUIbe3ps2T86KXAzvXzdpFcgs5Mvku03uZ8w<span class="comment">'</span></code></pre>
<p>And the response:

</p>
<pre><code class="shell">{
 "<span class="attribute">access_token</span>":<span class="value"><span class="string">"2a84a6ddb229c13bc945874b69fab8ba"</span></span>,
 "<span class="attribute">course_provider_id</span>":<span class="value"><span class="literal">null</span></span>,
 "<span class="attribute">created_at</span>":<span class="value"><span class="string">"2013-07-03T00:25:37Z"</span></span>,
 "<span class="attribute">expires_at</span>":<span class="value"><span class="literal">null</span></span>,
 "<span class="attribute">id</span>":<span class="value"><span class="number">2038</span></span>,
 "<span class="attribute">realm_id</span>":<span class="value"><span class="number">4</span></span>,
 "<span class="attribute">token_type</span>":<span class="value"><span class="literal">null</span></span>,
 "<span class="attribute">updated_at</span>":<span class="value"><span class="string">"2013-07-03T00:25:37Z"</span></span>,
 "<span class="attribute">user_id</span>":<span class="value"><span class="literal">null</span>
</span>}</code></pre>
<p>We can now use the &quot;access_token&quot; returned as an API key in an insecure situation:

</p>
<pre><code class="shell">curl <span class="comment">'http://localhost:3000/bright/api/v2/course?</span>
api_key=<span class="number">2</span>a84a6ddb229c13bc945874b69fab8ba<span class="comment">'</span></code></pre>
<p>Or in a secure situation, you can use the realm key directly:

</p>
<pre><code class="shell">curl <span class="comment">'http://localhost:3000/bright/api/v2/course?</span>
realm_guid=sJLtP8Zt8G0Sbz9kxPjQ&amp;
realm_secret_key=PcVQflTCUIbe3ps2T86KXAzvXzdpFcgs5Mvku03uZ8w<span class="comment">'</span></code></pre>
<h2 id='api-modules'>API Modules</h2 id='api-modules'>
<p>Note not all RESTFul function are implemented.

</p>
<h3 id='api-modules/registration'>Registration</h3 id='api-modules/registration'>
<h4>Method: index</h4>
<p>The index method allows the api user to query registrations.

</p>
<h4>HTTP Model:</h4>
<table>
  <tr>
    <th>Verb</th>
    <th>Form</th>
  </tr><br>  <tr>
    <td>GET</td>
    <td>(http|https)://BRIGHT_URL/bright/api/v2/registration[.format]?param1=value1&amp;...</td>
  </tr>
</table>

<h5>Parameters</h5>
<table>
  <tr>
    <th>Parameter</th>
    <th>Example</th>
    <th>Notes</th>
  </tr>
   <tr>
     <td><strong>access method</strong></td>
     <td>api_key=<a href="#access-modes">an api key created previously</td>
     <td>see [Access Modes</a></td>
  </tr>
  <tr>
    <td>last_only</td>
    <td>last_only=t</td>
    <td>when included in the parameter string, we will return a single registration
    record, that being the last one created.  Useful in cases where multiple registrations are found and only the most recent one
should be returned.</td>
  </tr><br>  <tr>
    <td>sc_course_id</td>
      <td>sc_course_id=a_scorm_cloud_course_id</td>
    <td>filter registrations to the specified course id.</td>
  </tr><br>  <tr>
    <td>learner_id</td>
      <td>learner_id=jane.doe@me.com</td>
    <td>filter registrations to the specified learner_id.</td>
  </tr><br>  <tr>
    <td>refresh_if_launched</td>
    <td>refresh_if_launched=t</td>
    <td>if the last launch date of this registration is newer than the last crawl date, this will force the record to recrawl prior to returning a result.</td>
  </tr><br>  <tr>
    <td>crawl</td>
      <td>crawl=t</td>
    <td>forces the registration to recrawl</td>
  </tr><br>
</table>

<h5>Example</h5>
<pre><code><span class="title">curl</span> -w <span class="string">"%{http_code}"</span> <span class="string">'http://localhost:3000/bright/api/v2/registration.json?
api_key=2a84a6ddb229c13bc945874b69fab8ba&amp;
learner_id=bret<span class="variable">@aura</span>-software.com&amp;
sc_course_id=16-4fbd9ea698bce</code></pre>
<h5>HTTP Codes</h5>
<table>
  <tr><br>    <th>Code</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>200</td>
    <td>Success; items returned</td>
  </tr><br>  <tr>
    <td>401</td>
    <td>If you do not specify a valid api_key, sc_app_id/sc_secret_key or realm_guid/realm_secret_key, you will receive HTTP error
401 (unauthorized).</td>
  </tr><br>  <tr>
    <td>500</td>
    <td>An illegal request, such as a malformed argument.</td>
  </tr><br></table>

<h4>Method: create</h4>
<p>Creates a new scorm cloud registration.  Can be used in a single call that can be used to return an existing registration if
one exists, or create a new one if it does not.

</p>
<h5>Parameters</h5>
<table>
  <tr>
    <th>Parameter</th>
    <th>Example</th>
    <th>Notes</th>
  </tr>
   <tr>
     <td><strong>access method</strong></td>
     <td>api_key=[an api key created previously]</td>
     <td>see <a href="#access-modes">Access Modes</a></td>
  </tr>
  <tr>
   <td>sc_app_id</td>
   <td>sc_app_id=XXXXYYYYZZZ [a valid app ID]</td>
   <td>SCORMCloud application ID (required)</td>
  </tr>

  <tr>
   <td>sc_secret_key</td>
   <td>sc_secret_key=XXXXYYYYZZZ [a valid app secret key]</td>
   <td>SCORMCloud application secret key (required)</td>
  </tr>

  <tr>
   <td>sc_course_id</td>
   <td>sc_course_id=16-4fbd9ea698bce</td>
   <td>SCORMCloud course ID (required)</td>
  </tr>
  <tr>
   <td>learner_id</td>
   <td>learner_id=bret@aura-software.com</td>
   <td>email address of user (required)</td>
  </tr>
  <tr>
   <td>dont_duplicate</td>
   <td>dont_duplicate=t</td>
   <td>check for an existing registration for this course and user, just return that if found. (optional)</td>
  </tr>
  <tr>
   <td>check_scorm_cloud</td>
      <td>check_scorm_cloud=t</td>
   <td>check the SCORMCloud API for existing registrations as well as the local Bright database (optional).  This can be useful in test scenarios where Bright SCORMCloud crawler is not functioning, and it is desirable not to create a lot of duplicate registrations.  Typically not used in production.</td>
  </tr>
  <tr>
   <td>fname</td>
   <td>fname=bret</td>
   <td>Can be used to set the first name in the SCORMCloud registration.</td>
  </tr>
  <tr>
   <td>lname</td>
      <td>lname=weinraub</td>
   <td>Can be used to set the last name in the SCORMCloud registration.</td>
  </tr>
</table>

<h5>HTTP Codes</h5>
<table>
  <tr><br>    <th>Code</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>201</td>
    <td>Success; item created</td>
  </tr><br>  <tr>
    <td>401</td>
    <td>If you do not specify a valid sc_app_id/sc_secret_key or realm_guid/realm_secret_key, you will receive HTTP error
401 (unauthorized).</td>
  </tr><br>  <tr>
    <td>403</td>
    <td>In some cases an additional error message is returned (see below).</td>
  </tr><br>  <tr>
    <td>404</td>
    <td>You provided a sc_course_id that can&#39;t be found for this access method, or none at all.  If you are using the create (and not gcreate alias),
make sure you are posting the data correctly.</td>
  </tr><br>  <tr>
    <td>500</td>
    <td>If you specify a user_email that is not valid, or a valid sc_course_id, you will receive a 500 server error.</td>
  </tr><br></table>

<p>In case of errors accessing the SCORMCloud API, a message including the error is returned (error code 403):

</p>
<pre><code class="shell">{
"<span class="attribute">error_code</span>":<span class="value"><span class="string">"4"</span></span>,
"<span class="attribute">error_message</span>":<span class="value"><span class="string">"The maximum number of registrations has been reached."</span></span>,
"<span class="attribute">error_url</span>":<span class="value"><span class="string">"http://cloud.scorm.com/api?email=..."</span>
</span>}</code></pre>
<p>Please note if you are using JSONP, since there are limited facillities to capture errors via JSONP, we
will return error code 200, with the error block above.  Otherwise you might find it difficult to correctly
handle this error.

</p>
<h5>Example</h5>
<p>For a successful request returned will be an XML or JSON document of the SCORMCloud registration.  Note this example is 
using the gcreate alias (using an HTTP get).

</p>
<pre><code>
curl -w <span class="string">"%{http_code}"</span> 
<span class="string">'http://localhost:3000/bright/api/v2/registration/gcreate.json?
api_key=2a84a6ddb229c13bc945874b69fab8ba&amp;
learner_id=bret@aura-software.com&amp;
sc_course_id=16-4fbd9ea698bce&amp;
sc_app_id=XXXYYYYZZZ&amp;
sc_secret_key=nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N&amp;
dont_duplicate=t'</span>
{
 <span class="string">"attempts"</span>=><span class="number">2</span>,
 <span class="string">"complete"</span>=><span class="string">"complete"</span>,
 <span class="string">"course_result"</span>=><span class="string">'&lt;?xml version="1.0" encoding=...?> &lt;rsp>...&lt;/rsp>'</span>,
 <span class="string">"crawl_error_msg"</span>=>nil,
 <span class="string">"crawl_status"</span>=><span class="string">"success"</span>,
 <span class="string">"crawl_type"</span>=><span class="string">"course"</span>,
 <span class="string">"created_at"</span>=><span class="string">"2012-12-21T08:39:12Z"</span>,
 <span class="string">"full_result"</span>=>nil,
 <span class="string">"id"</span>=><span class="number">5336</span>,
 <span class="string">"last_crawled_at"</span>=><span class="string">"2012-12-12T16:33:33Z"</span>,
 <span class="string">"learner_id"</span>=><span class="string">"bret@aura-software.com"</span>,
 <span class="string">"number_of_crawl_errors"</span>=><span class="number">0</span>,
 <span class="string">"sc_completed_at"</span>=>nil,
 <span class="string">"sc_course_id"</span>=><span class="string">"20-NSFoundationPostTrainingQuiz"</span>,
 <span class="string">"sc_created_at"</span>=><span class="string">"2012-12-12T16:32:04Z"</span>,
 <span class="string">"sc_deleted"</span>=>nil,
 <span class="string">"sc_err_code"</span>=>nil,
 <span class="string">"sc_error_message"</span>=>nil,
 <span class="string">"sc_last_accessed_at"</span>=>nil,
 <span class="string">"sc_registration_id"</span>=><span class="string">"79c0dd35-139-048258-16e-9a1561b0a85d"</span>,
 <span class="string">"score"</span>=><span class="number">99.2</span>,
 <span class="string">"course_provider_id"</span>=><span class="number">10</span>,
 <span class="string">"course_id"</span>=><span class="number">509</span>,
 <span class="string">"success"</span>=><span class="string">"succeeded"</span>,
 <span class="string">"totaltime"</span>=><span class="number">100.0</span>,
 <span class="string">"updated_at"</span>=><span class="string">"2012-12-21T08:39:12Z"</span>
}</code></pre>
<h3 id='api-modules/course'>Course</h3 id='api-modules/course'>
<h4>Method: Index</h4>
<p>The index method allows the api user to fetch a course list.

</p>
<h4>HTTP Model:</h4>
<table>
  <tr>
    <th>Verb</th>
    <th>Form</th>
  </tr><br>  <tr>
    <td>GET</td>
    <td>(http|https)://BRIGHT_URL/bright/api/v2/course[.format]?param1=value1&amp;...</td>
  </tr>
</table>

<h4>Parameters</h4>
<table>
  <tr>
    <th>Parameter</th>
    <th>Example</th>
    <th>Notes</th>
  </tr>
   <tr>
     <td><strong>access method</strong></td>
     <td>api_key=[an api key created previously]</td>
     <td>see <a href="#access-modes">Access Modes</a></td>
  </tr>
</table>

<h4>Example</h4>
<pre><code><span class="title">curl</span> -w <span class="string">"%{http_code}"</span> <span class="string">'http://localhost:3000/bright/api/v2/course.json?
learner_id=bret<span class="variable">@aura</span>-software.com&amp;
sc_course_id=16-4fbd9ea698bce</code></pre>
<h4>HTTP Codes</h4>
<table>
  <tr><br>    <th>Code</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>200</td>
    <td>Success; items returned</td>
  </tr><br>  <tr>
    <td>401</td>
    <td>If you do not specify a valid api_key, sc_app_id/sc_secret_key or realm_guid/realm_secret_key, you will receive HTTP error
401 (unauthorized).</td>
  </tr><br>  <tr>
    <td>500</td>
    <td>An illegal request, such as a malformed argument.</td>
  </tr><br></table>

<h3 id='api-modules/realm-user'>Realm User</h3 id='api-modules/realm-user'>
<p>For learners, its generally not necessary to prepopulate realm users as creating a registration implicitly creates the user.

</p>
<p>It is possible to create them via the API and also manipulate their custom field as well.

</p>
<h4>Method: create</h4>
<p>Creates a new realm user.  You must use a realm guid and secret key (or api key creating bound to a realm key) to create a realm user.

</p>
<h5>Parameters</h5>
<table>
  <tr>
    <th>Parameter</th>
    <th>Example</th>
    <th>Notes</th>
  </tr>
   <tr>
     <td><strong>access method</strong></td>
     <td>api_key=[an api key created previously]</td>
     <td>see <a href="#access-modes">Access Modes.  You cannot use a SCORMCloud app-id/secret key or user bound api key to create a realm user.</a></td>
  </tr>
  <tr>
   <td>email</td>
   <td>email=bret@aura-software.com</td>
   <td>email address of the user (required)</td>
  </tr>
  <tr>
    <td>realm_role_id</td>
    <td>realm_role_id=1</td>
    <td>Define the realm role.  Not required, defaults to &#39;1&#39; (learner).  </td>
  </tr><br>  <tr>
    <td>custom</td>
    <td>custom=&#39;{this:that}&#39;</td>
    <td>Define a custom field for this user.  Custom fields are freeform metadata available to be defined for the user.</td>
  </tr>
</table>



<h5>HTTP Codes</h5>
<table>
  <tr><br>    <th>Code</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>201</td>
    <td>Success; item created</td>
  </tr><br>  <tr>
    <td>302</td>
    <td>Item already exists, not modified.</td>
  </tr><br>  <tr>
    <td>500</td>
    <td>If you specify a user_email that is not valid, or a valid sc_course_id, you will receive a 500 server error.</td>
  </tr><br></table>

<h5>Example</h5>
<pre><code>curl -w "%{http_code}" 
'http://localhost:3000/bright/api/v2/realm_user/gcreate.xml?
api_key=2a84a6ddb229c13bc945874b69fab8ba&amp;
email=bretx@aura-software.com&amp;
custom=foo'
<span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="tag">&lt;<span class="title">realm-user</span>></span>
  <span class="tag">&lt;<span class="title">created-at</span> <span class="attribute">type</span>=<span class="value">"datetime"</span>></span>2013-07-03T05:26:21Z<span class="tag">&lt;/<span class="title">created-at</span>></span>
  <span class="tag">&lt;<span class="title">custom</span>></span>foo<span class="tag">&lt;/<span class="title">custom</span>></span>
  <span class="tag">&lt;<span class="title">id</span> <span class="attribute">type</span>=<span class="value">"integer"</span>></span>1743<span class="tag">&lt;/<span class="title">id</span>></span>
  <span class="tag">&lt;<span class="title">realm-id</span> <span class="attribute">type</span>=<span class="value">"integer"</span>></span>4<span class="tag">&lt;/<span class="title">realm-id</span>></span>
  <span class="tag">&lt;<span class="title">realm-role-id</span> <span class="attribute">type</span>=<span class="value">"integer"</span>></span>1<span class="tag">&lt;/<span class="title">realm-role-id</span>></span>
  <span class="tag">&lt;<span class="title">updated-at</span> <span class="attribute">type</span>=<span class="value">"datetime"</span>></span>2013-07-03T05:26:21Z<span class="tag">&lt;/<span class="title">updated-at</span>></span>
  <span class="tag">&lt;<span class="title">user-id</span> <span class="attribute">type</span>=<span class="value">"integer"</span>></span>1686<span class="tag">&lt;/<span class="title">user-id</span>></span>
<span class="tag">&lt;/<span class="title">realm-user</span>></span>
201</code></pre>
<h4>Method: update (gupdate)</h4>
<p>Update a realm user.  You must use a realm guid and secret key (or api key creating bound to a realm key) to update a realm user.

</p>
<h5>Parameters</h5>
<table>
  <tr>
    <th>Parameter</th>
    <th>Example</th>
    <th>Notes</th>
  </tr>
   <tr>
     <td><strong>access method</strong></td>
     <td>api_key=[an api key created previously]</td>
     <td>see <a href="#access-modes">Access Modes.  You cannot use a SCORMCloud app-id/secret key or user bound api key to create a realm user.</a></td>
  </tr>
  <tr>
   <td>email</td>
   <td>email=bret@aura-software.com</td>
   <td>email address of the user (required)</td>
  </tr>
  <tr>
    <td>custom</td>
    <td>custom=&#39;{this:that}&#39;</td>
    <td>Define a custom field for this user.  Custom fields are freeform metadata available to be defined for the user.</td>
  </tr>
</table>


<h5>HTTP Codes</h5>
<table>
  <tr><br>    <th>Code</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>200</td>
    <td>Success; item created</td>
  </tr><br>  <tr>
    <td>404</td>
    <td>Realm user cannot be found..</td>
  </tr><br>  <tr>
    <td>500</td>
    <td>If you specify a user_email that is not valid, or supply unexpected parameters, you will receive a 500 server error.</td>
  </tr><br></table>

<h5>Example</h5>
<pre><code><span class="title">curl</span> -w <span class="string">"%{http_code}"</span> 
<span class="string">'http://localhost:3000/bright/api/v2/realm_user/gupdate.xml?
api_key=2a84a6ddb229c13bc945874b69fab8ba&amp;
email=bretx<span class="variable">@aura</span>-software.com&amp;
custom=foox'</span>
<span class="number">200</span></code></pre>
<h3 id='api-modules/api-key'>API Key</h3 id='api-modules/api-key'>
<p>The API Key interface allows for the creation of API keys for Bright Server.

</p>
<h4>Method: create</h4>
<h4>HTTP Model:</h4>
<table>
  <tr>
    <th>Verb</th>
    <th>Form</th>
  </tr><br>  <tr>
    <td>Post</td>
    <td>(http|https)://BRIGHT_URL/bright/api/v2/api_key?param1=value1&amp;...</td>
  </tr>
</table>

<h5>Parameters</h5>
<table>
  <tr>
    <th>Parameter</th>
    <th>Example</th>
    <th>Notes</th>
  </tr>
  <tr>
    <td>sc_app_id</td>
    <td></td>
    <td>(optional) <bold>You must use either sc_app_id and sc_secret_key OR realm_guid and realm_secret_key.</bold></td>
   </tr>
   <tr>
    <td>sc_secret_key</td>
    <td></td>
    <td>(optional)</td>
   </tr>
   <tr>
    <td>realm_guid</td>
    <td></td>
    <td>(optional) <bold>You must use either sc_app_id and sc_secret_key OR realm_guid and realm_secret_key.</bold></td>
   </tr>
   <tr>
    <td>realm_secret_key</td>
    <td></td>
    <td>(optional)</td>
   </tr>
   <tr>
    <td>user_email</td>
    <td>user_email=jane.doe@me.com</td>
    <td>(optional).  When specifying a user email when generating an API key, this api key will be &quot;bound&quot; to this user
and will be unable to access data unrelated from the user.  If you do not set user_email, the generated token will have unlimited (administrative) access to
the SCORMCloud application or Bright Realm specified.
<p>
If you specify an email that is new to the system, an account is automatically created for that user,
and the new user is attached as a subscriber class user to the Bright Realm attached to the this SCORM
Cloud application.</td>
   </tr>
</table>        

<h5>Return Data</h5>
<p>Returns a JSON document of the new record.  HTTP Code is set to 201 (item created).

</p>
<h5>Example:</h5>
<pre><code>curl -w <span class="string">"%{http_code}"</span> -d <span class="comment">'sc_app_id=RQIBAXU49I</span>
&amp;sc_secret_key=nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N
&amp;user_email=admin@aura-software.com<span class="comment">' http://[BRIGHT URL]/bright/api/v2/api_key/</span>

{
 <span class="string">"access_token"</span>:<span class="string">"a440b1ad868bc76716d22b4b827db77e"</span>,
 <span class="string">"created_at"</span>:<span class="string">"2012-12-18T12:16:29Z"</span>,
 <span class="string">"expires_at"</span>:<span class="literal">null</span>,
 <span class="string">"id"</span>:<span class="number">139</span>,
 <span class="string">"course_provider_id"</span>:<span class="number">6</span>,
 <span class="string">"token_type"</span>:<span class="literal">null</span>,
 <span class="string">"updated_at"</span>:<span class="string">"2012-12-18T12:16:29Z"</span>,
 <span class="string">"user_id"</span>:<span class="number">12</span>
}
<span class="number">201</span></code></pre>
<p>Note that this is a POST request, so you must configure your client appropriately.  In the case of
curl, this is accomplished with the <strong>-d</strong> flag.

</p>
<p>The &#39;-w %{http_code}&#39; piece allows you to view the returned HTTP code.


</p>
<h5>HTTP Codes</h5>
<table>
  <tr><br>    <th>Code</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>201</td>
    <td>Success; item created</td>
  </tr><br>  <tr>
    <td>401</td>
    <td>If you do not specify a valid sc_app_id/sc_secret_key or realm_guid/realm_secret_key, you will receive HTTP error
401 (unauthorized).</td>
  </tr><br>  <tr>
    <td>500</td>
    <td>If you specify a user_email that is not valid, you will receive a 500 server error.</td>
  </tr><br></table>


<h2 id='debugging-errors'>Debugging Errors</h2 id='debugging-errors'>
<p>The Bright API, if it&#39;s not happy with its input, isn&#39;t going to give you that much information as to why.  It doesn&#39;t produce error messages
other than HTTP codes.  This is primarily for security reasons.  Since we listen on public ports, we don&#39;t want people probing the api, and using
the error messages as a guide to on how to gain access.

</p>
<p>From curl, if you put an invalid response, you&#39;ll get no data back:

</p>
<pre><code class="shell">curl <span class="comment">'http://[BRIGHT URL]/bright/api/v2/course.json?sc_app_id=RQIBAXU49I</span>
&amp;sc_secret_key=nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N<span class="comment">'</span></code></pre>
<p>We asked for a jsonc format, which of course doesn&#39;t exist.

</p>
<p>The only information you will get is an HTTP error code, in this case 406, &#39;Not Acceptable&#39;.

</p>
<h3 id='debugging-errors/fetching-http-error-codes-from-a-get-request'>Fetching HTTP Error Codes from a GET Request</h3 id='debugging-errors/fetching-http-error-codes-from-a-get-request'>
<p>You can see the HTTP response code for a GET request in curl with the -I flag:

</p>
<pre><code class="shell">curl <span class="comment">'http://[BRIGHT URL]/bright/api/v2/course.json?</span>
sc_app_id=RQIBAXU49I&amp;
sc_secret_key=nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N<span class="comment">' -I</span>
 HTTP/<span class="number">1.1</span> <span class="number">406</span> <span class="keyword">Not</span> Acceptable
 Content-Type: text/html; charset=utf-<span class="number">8</span>
 X-Ua-Compatible: IE=Edge,chrome=<span class="number">1</span>
 Cache-Control: no-cache
 X-<span class="built_in">Request</span>-Id: d4da4e1010b84640e1657b731ada79a3
 X-Runtime: <span class="number">0.004287</span>
 <span class="built_in">Date</span>: Fri, <span class="number">07</span> Dec <span class="number">2012</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">10</span> GMT
 X-Rack-Cache: miss
 Content-Length: <span class="number">0</span>
 <span class="built_in">Server</span>: WEBrick/<span class="number">1.3</span> (Ruby/<span class="number">1.9</span>/<span class="number">2012</span>-<span class="number">04</span>-<span class="number">20</span>)
 Connection: Keep-Alive</code></pre>
<p>You will also get no data from a request that matches no data.  But in this case, the HTTP code will be 200

</p>
<pre><code class="shell">curl <span class="comment">'http://[BRIGHT URL]/bright/api/v2/course.json?sc_app_id=RQIBAXU49I\</span>
&amp;sc_secret_key=nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N&amp;title=nosuchcourse<span class="comment">'</span></code></pre>
<p>[]

</p>
<pre><code class="shell">curl <span class="comment">'http://[BRIGHT URL]/bright/api/v2/course.json?sc_app_id=RQIBAXU49I</span>
&amp;sc_secret_key=nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N&amp;title=nosuchcourse<span class="comment">' -I</span>
  HTTP/<span class="number">1.1</span> <span class="number">200</span> OK
  Content-Type: application/json; charset=utf-<span class="number">8</span>
  X-Ua-Compatible: IE=Edge,chrome=<span class="number">1</span>
  Etag: <span class="string">"d751713988987e9331980363e24189ce"</span>
  Cache-Control: max-age=<span class="number">0</span>, <span class="keyword">private</span>, must-revalidate
  X-<span class="built_in">Request</span>-Id: <span class="number">73</span>a4966a2a62ca4e70316f6a68645b51
  X-Runtime: <span class="number">0.006220</span>
  <span class="built_in">Date</span>: Fri, <span class="number">07</span> Dec <span class="number">2012</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">40</span> GMT
  X-Rack-Cache: miss
  Content-Length: <span class="number">0</span>
  <span class="built_in">Server</span>: WEBrick/<span class="number">1.3</span> (Ruby/<span class="number">1.9</span>/<span class="number">2012</span>-<span class="number">04</span>-<span class="number">20</span>)
  Connection: Keep-Alive</code></pre>
<h3 id='debugging-errors/fetching-http-error-codes-from-a-post-request'>Fetching HTTP Error Codes from a POST Request</h3 id='debugging-errors/fetching-http-error-codes-from-a-post-request'>
<p>Since we use a RESTful API, some operations require a POST HTTP verb.  For whatever reason, the -I flag in curl
will not show you the HTTP return code for a POST.

</p>
<p>Instead use the following:

</p>
<pre><code class="shell"><span class="title">curl</span> -w <span class="string">"%{http_code}"</span>  -d <span class="string">'sc_app_id=RQIBAXU49Ix&amp;sc_secret_key=\
nCwrTDSy1MzaeyhN0TFfi3uH3huzlu6CNmyHUG5N&amp;user_email=newuser<span class="variable">@aura</span>-software.com'</span> \
<span class="url">http://[BRIGHT</span> URL]/bright/api/v2/api_key</code></pre>
<p>-w %{http_code} is the key part of that.

</p>
<h3 id='debugging-errors/debugging-authentication-errors'>Debugging Authentication Errors</h3 id='debugging-errors/debugging-authentication-errors'>
<p>If you receive a 401 code from the API, the server itself has recorded the authentication error in the server log.
If you are completely stumped, this is the place to look.

</p>
<p>An error like this should exists:

</p>
<pre><code class="shell">Processing by ScormCloudCourseController<span class="comment">#index as JSON</span>
  Parameters: {<span class="string">"api_key"</span>=><span class="string">"bogus!"</span>, <span class="string">"sc_course_id"</span>=><span class="string">"course1"</span>}
  [<span class="number">1</span>m[<span class="number">36</span>mApiKey Load (<span class="number">0.4</span>ms)[<span class="number">0</span>m  [<span class="number">1</span>mSELECT <span class="string">"api_keys"</span>.* FROM 
  <span class="string">"api_keys"</span> WHERE <span class="string">"api_keys"</span>.<span class="string">"access_token"</span> = <span class="string">'bogus!'</span> LIMIT <span class="number">1</span>[<span class="number">0</span>m
Unauthorized: api token <span class="keyword">not</span> found
Filter chain halted <span class="keyword">as</span> :restrict_access rendered <span class="keyword">or</span> redirected
Completed <span class="number">401</span> Unauthorized <span class="keyword">in</span> <span class="number">2</span>ms (ActiveRecord: <span class="number">0.4</span>ms)</code></pre>
<p>Definitely give us a shout if you can&#39;t get an API call to work at support@aura-software.com.
</p>

  </div>
</div></body>
</html>